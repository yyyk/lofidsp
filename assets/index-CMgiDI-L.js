(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function l(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function c(e){if(e.ep)return;e.ep=!0;const n=l(e);fetch(e.href,n)}})();function b(t,o){const l=(1<<o-1)-1;return Math.round(t*l)/l}function x(t,o){return Float32Array.from(t,l=>b(l,o))}function H(t,o,l){if(o<l)throw new Error("inputRate should be larger than outputRate");const c=o/l,e=new Float32Array(Math.floor(t.length/c));for(let n=0;n<e.length;n++)e[n]=t[Math.floor(n*c)];return e}function B(t,o,l){const c=new ArrayBuffer(44+t.length*2),e=new DataView(c);function n(a,i){for(let s=0;s<i.length;s++)e.setUint8(a+s,i.charCodeAt(s))}n(0,"RIFF"),e.setUint32(4,36+t.length*2,!0),n(8,"WAVE"),n(12,"fmt "),e.setUint32(16,16,!0),e.setUint16(20,1,!0),e.setUint16(22,l,!0),e.setUint32(24,o,!0),e.setUint32(28,o*l*2,!0),e.setUint16(32,l*2,!0),e.setUint16(34,16,!0),n(36,"data"),e.setUint32(40,t.length*2,!0);let r=44;for(let a=0;a<t.length;a++){const i=Math.max(-1,Math.min(1,t[a]));e.setInt16(r,i<0?i*32768:i*32767,!0),r+=2}return new Blob([c],{type:"audio/wav"})}function D(t,o,l){const c=new Float32Array(t.length),e=2*Math.PI*l,n=e/(e+o);c[0]=t[0];for(let r=1;r<t.length;r++)c[r]=n*t[r]+(1-n)*c[r-1];return c}function w(t,o){const l=Math.pow(2,o/12),c=Math.floor(t.length/l),e=new Float32Array(c);for(let n=0;n<c;n++){const r=n*l,a=Math.floor(r),i=Math.min(t.length-1,Math.ceil(r)),s=r-a;e[n]=(1-s)*t[a]+s*t[i]}return e}function z(t){if(t.numberOfChannels<2)return t;const o=t.length,l=t.sampleRate,c=t.getChannelData(0),e=t.getChannelData(1),n=new Float32Array(o);for(let a=0;a<o;a++)n[a]=(c[a]+e[a])/2;const r=new AudioContext().createBuffer(1,o,l);return r.copyToChannel(n,0),r}function C(t,o,l){if(o>l)throw new Error("inputRate should be smaller than outputRate");const c=l/o,e=new Float32Array(Math.floor(t.length*c));for(let n=0;n<e.length;n++){const r=n/c,a=Math.floor(r),i=Math.min(t.length-1,Math.ceil(r)),s=r-a;e[n]=(1-s)*t[a]+s*t[i]}return e}const d={"48kHz":48e3,"44.1kHz":44100,"24kHz":24e3,"12kHz":12e3},I=[{targetSampleRate:d["24kHz"],targetBitDepth:12,octave:0},{targetSampleRate:d["24kHz"],targetBitDepth:12,octave:1},{targetSampleRate:d["24kHz"],targetBitDepth:12,octave:2},{targetSampleRate:d["24kHz"],targetBitDepth:8,octave:0},{targetSampleRate:d["24kHz"],targetBitDepth:8,octave:1},{targetSampleRate:d["24kHz"],targetBitDepth:8,octave:2},{targetSampleRate:d["12kHz"],targetBitDepth:12,octave:0},{targetSampleRate:d["12kHz"],targetBitDepth:12,octave:1},{targetSampleRate:d["12kHz"],targetBitDepth:12,octave:2},{targetSampleRate:d["12kHz"],targetBitDepth:8,octave:0},{targetSampleRate:d["12kHz"],targetBitDepth:8,octave:1},{targetSampleRate:d["12kHz"],targetBitDepth:8,octave:2}];function $(t,o=d["24kHz"],l=12,c=1){t=z(t);const e=t.sampleRate,n=t.numberOfChannels,r=new Float32Array(t.length*n);for(let i=0;i<t.length;i++)for(let s=0;s<n;s++)r[i*n+s]=t.getChannelData(s)[i];let a=C(r,e,d["48kHz"]);return a=w(a,12*c),a=H(a,d["48kHz"],o),a=x(a,l),a=D(a,o,o*2/3),a=w(a,-12*c),a=C(a,o,d["44.1kHz"]),[a,d["44.1kHz"],n]}function L(t,o,l,c){return`${t.replace(/\.[^/.]+$/,"")}_${o}Hz_${l}bit_${c>0?c:"un"}pre-pitched.wav`}function S(t,o,l){var E;const{targetSampleRate:c,targetBitDepth:e,octave:n}=l,[r,a,i]=$(o,c,e,n),s=B(r,a,i),m=URL.createObjectURL(s),h=`${c}_${e}_${n}`;let u=document.getElementById(`section_${h}`);u||(u=document.createElement("div"),u.id=`section_${h}`,(E=document.getElementById("audio-container"))==null||E.appendChild(u));let f=document.getElementById(`title_${h}`);f||(f=document.createElement("p"),f.id=`title_${h}`,u.appendChild(f)),f.innerHTML=`${c}Hz / ${e}bit${n>0?`<br/><span class="small-text">${n} octave${n>1?"s":""} pre-pitched<span>`:""}`;let p=document.getElementById(`audio_${h}`);p||(p=document.createElement("audio"),p.id=`audio_${h}`,p.controls=!0,u.appendChild(p)),p.src=m;let g=document.getElementById(`button_${h}`);g&&u.removeChild(g),g=document.createElement("button"),g.id=`button_${h}`,g.innerText="download",g.addEventListener("click",()=>{const v=document.createElement("a");v.href=m,v.download=L(t,c,e,n),v.click()}),u.appendChild(g)}let y;async function k(t){const o=t.target.files[0];if(!o)return;const l=document.getElementById("input-container"),c=l.querySelector(".drag-text");c.textContent=`âœ… ${o.name} selected`,c.style.color="var(--mpc-red)";const e=document.getElementById("original-audio");e&&l.removeChild(e);const n=document.getElementById("audio-container");n.innerHTML="";let r;try{const i=await o.arrayBuffer();y&&y.close(),y=new window.AudioContext({sampleRate:d["44.1kHz"]}),r=await y.decodeAudioData(i)}catch{R();return}let a;try{const i=new OfflineAudioContext(r.numberOfChannels,r.length,r.sampleRate),s=i.createBufferSource();s.buffer=r;const m=i.createGain();m.gain.value=1,s.connect(m).connect(i.destination),s.start(),a=await i.startRendering()}catch{return}{const{numberOfChannels:i,sampleRate:s}=a,m=new Float32Array(a.length*i);for(let p=0;p<a.length;p++)for(let g=0;g<i;g++)m[p*i+g]=a.getChannelData(g)[p];const h=B(m,s,i),u=URL.createObjectURL(h);let f=document.getElementById("original-audio");f||(f=document.createElement("audio"),f.id="original-audio",f.controls=!0,l.appendChild(f)),f.src=u}I.forEach(i=>S(o.name,a,i))}function R(){const o=document.getElementById("input-container").querySelector(".drag-text");o.textContent="âŒ Please select an audio file",o.style.color="var(--text-error)",setTimeout(()=>{o.textContent="ðŸ“ Select an audio file or drag & drop here",o.style.color="var(--text-secondary)"},3e3)}function M(){const t=document.getElementById("input-container"),o=document.getElementById("fileInput");["dragenter","dragover","dragleave","drop"].forEach(r=>{t.addEventListener(r,l,!1),document.body.addEventListener(r,l,!1)}),["dragenter","dragover"].forEach(r=>{t.addEventListener(r,c,!1)}),["dragleave","drop"].forEach(r=>{t.addEventListener(r,e,!1)}),t.addEventListener("drop",n,!1);function l(r){r.preventDefault(),r.stopPropagation()}function c(){t.classList.add("drag-over")}function e(){t.classList.remove("drag-over")}function n(r){const a=r.dataTransfer;if(!a)return;const i=a.files;if(i.length>0){const s=i[0];if(s.type.startsWith("audio/")){const m=new DataTransfer;m.items.add(s),o.files=m.files;const h=new Event("change",{bubbles:!0});o.dispatchEvent(h);const u=t.querySelector(".drag-text");u.textContent=`âœ… ${s.name} selected`,u.style.color="var(--mpc-red)"}else R()}}o.addEventListener("change",k)}M();
