(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function l(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(e){if(e.ep)return;e.ep=!0;const o=l(e);fetch(e.href,o)}})();function D(t,r){const l=(1<<r-1)-1;return Math.round(t*l)/l}function b(t,r){return Float32Array.from(t,l=>D(l,r))}function I(t,r){const l=new Float32Array(t.length);l[0]=t[0];for(let a=1;a<t.length;a++)l[a]=r*t[a]+(1-r)*l[a-1];return l}function $(t,r,l,a=!1){const e=r/l,o=a?I(t,.1):t,c=new Float32Array(Math.floor(o.length/e));for(let n=0;n<c.length;n++)c[n]=o[Math.floor(n*e)];return c}function x(t,r,l){const a=new ArrayBuffer(44+t.length*2),e=new DataView(a);function o(n,i){for(let s=0;s<i.length;s++)e.setUint8(n+s,i.charCodeAt(s))}o(0,"RIFF"),e.setUint32(4,36+t.length*2,!0),o(8,"WAVE"),o(12,"fmt "),e.setUint32(16,16,!0),e.setUint16(20,1,!0),e.setUint16(22,l,!0),e.setUint32(24,r,!0),e.setUint32(28,r*l*2,!0),e.setUint16(32,l*2,!0),e.setUint16(34,16,!0),o(36,"data"),e.setUint32(40,t.length*2,!0);let c=44;for(let n=0;n<t.length;n++){const i=Math.max(-1,Math.min(1,t[n]));e.setInt16(c,i<0?i*32768:i*32767,!0),c+=2}return new Blob([a],{type:"audio/wav"})}function L(t,r,l){const a=new Float32Array(t.length),e=1/(2*Math.PI*l),o=1/r,c=o/(e+o);a[0]=t[0];for(let n=1;n<t.length;n++)a[n]=a[n-1]+c*(t[n]-a[n-1]);return a}function C(t,r){const l=Math.pow(2,r/12),a=Math.floor(t.length/l),e=new Float32Array(a);for(let o=0;o<a;o++){const c=o*l,n=Math.floor(c),i=Math.min(t.length-1,Math.ceil(c)),s=c-n;e[o]=(1-s)*t[n]+s*t[i]}return e}function S(t){if(t.numberOfChannels<2)return t;const r=t.length,l=t.sampleRate,a=t.getChannelData(0),e=t.getChannelData(1),o=new Float32Array(r);for(let n=0;n<r;n++)o[n]=(a[n]+e[n])/2;const c=new AudioContext().createBuffer(1,r,l);return c.copyToChannel(o,0),c}function B(t,r,l){const a=l/r,e=new Float32Array(Math.floor(t.length*a));for(let o=0;o<e.length;o++){const c=o/a,n=Math.floor(c),i=Math.min(t.length-1,Math.ceil(c)),s=c-n;e[o]=(1-s)*t[n]+s*t[i]}return e}const A=[{targetSampleRate:24e3,targetBitDepth:12,octave:0},{targetSampleRate:24e3,targetBitDepth:12,octave:1},{targetSampleRate:24e3,targetBitDepth:12,octave:2},{targetSampleRate:24e3,targetBitDepth:8,octave:0},{targetSampleRate:24e3,targetBitDepth:8,octave:1},{targetSampleRate:24e3,targetBitDepth:8,octave:2},{targetSampleRate:12e3,targetBitDepth:12,octave:0},{targetSampleRate:12e3,targetBitDepth:12,octave:1},{targetSampleRate:12e3,targetBitDepth:12,octave:2},{targetSampleRate:12e3,targetBitDepth:8,octave:0},{targetSampleRate:12e3,targetBitDepth:8,octave:1},{targetSampleRate:12e3,targetBitDepth:8,octave:2}];function M(t,r=24e3,l=12,a=1){t=S(t);const e=t.sampleRate,o=t.numberOfChannels,c=new Float32Array(t.length*o);for(let i=0;i<t.length;i++)for(let s=0;s<o;s++)c[i*o+s]=t.getChannelData(s)[i];let n=B(c,e,48e3);return n=C(n,12*a),n=$(n,48e3,r),n=b(n,l),n=L(n,r,r*2/3),n=C(n,-12*a),n=B(n,r,44100),[n,44100,o]}function F(t,r,l,a){return`${t.replace(/\.[^/.]+$/,"")}_${r}Hz_${l}bit_${a>0?a:"un"}pre-pitched.wav`}function U(t,r,l){var y;const{targetSampleRate:a,targetBitDepth:e,octave:o}=l,[c,n,i]=M(r,a,e,o),s=x(c,n,i),m=URL.createObjectURL(s),u=`${a}_${e}_${o}`;let d=document.getElementById(`section_${u}`);d||(d=document.createElement("div"),d.id=`section_${u}`,(y=document.getElementById("audio-container"))==null||y.appendChild(d));let p=document.getElementById(`title_${u}`);p||(p=document.createElement("p"),p.id=`title_${u}`,d.appendChild(p)),p.innerHTML=`${a}Hz / ${e}bit${o>0?`<br/><span class="small-text">${o} octave${o>1?"s":""} pre-pitched<span>`:""}`;let f=document.getElementById(`audio_${u}`);f||(f=document.createElement("audio"),f.id=`audio_${u}`,f.controls=!0,d.appendChild(f)),f.src=m;let g=document.getElementById(`button_${u}`);g&&d.removeChild(g),g=document.createElement("button"),g.id=`button_${u}`,g.innerText="download",g.addEventListener("click",()=>{const h=document.createElement("a");h.href=m,h.download=F(t,a,e,o),h.click()}),d.appendChild(g)}let w;async function O(t){const r=t.target.files[0];if(!r)return;const l=document.getElementById("input-container"),a=l.querySelector(".drag-text");a.textContent=`âœ… ${r.name} selected`,a.style.color="var(--mpc-red)";const e=document.getElementById("original-audio");e&&l.removeChild(e);const o=document.getElementById("audio-container");o.innerHTML="";const c=await r.arrayBuffer();w&&w.close(),w=new window.AudioContext({sampleRate:44100});let n;try{n=await w.decodeAudioData(c)}catch{R();return}const i=new OfflineAudioContext(n.numberOfChannels,n.length,n.sampleRate),s=i.createBufferSource();s.buffer=n;const m=i.createGain();m.gain.value=1,s.connect(m).connect(i.destination),s.start();const u=await i.startRendering();{const{numberOfChannels:d,sampleRate:p}=u,f=new Float32Array(u.length*d);for(let v=0;v<u.length;v++)for(let E=0;E<d;E++)f[v*d+E]=u.getChannelData(E)[v];const g=x(f,p,d),y=URL.createObjectURL(g);let h=document.getElementById("original-audio");h||(h=document.createElement("audio"),h.id="original-audio",h.controls=!0,l.appendChild(h)),h.src=y}A.forEach(d=>U(r.name,u,d))}function R(){const r=document.getElementById("input-container").querySelector(".drag-text");r.textContent="âŒ Please select an audio file",r.style.color="var(--text-error)",setTimeout(()=>{r.textContent="ðŸ“ Select an audio file or drag & drop here",r.style.color="var(--text-secondary)"},3e3)}function _(){const t=document.getElementById("input-container"),r=document.getElementById("fileInput");["dragenter","dragover","dragleave","drop"].forEach(c=>{t.addEventListener(c,l,!1),document.body.addEventListener(c,l,!1)}),["dragenter","dragover"].forEach(c=>{t.addEventListener(c,a,!1)}),["dragleave","drop"].forEach(c=>{t.addEventListener(c,e,!1)}),t.addEventListener("drop",o,!1);function l(c){c.preventDefault(),c.stopPropagation()}function a(){t.classList.add("drag-over")}function e(){t.classList.remove("drag-over")}function o(c){const n=c.dataTransfer;if(!n)return;const i=n.files;if(i.length>0){const s=i[0];if(s.type.startsWith("audio/")){const m=new DataTransfer;m.items.add(s),r.files=m.files;const u=new Event("change",{bubbles:!0});r.dispatchEvent(u);const d=t.querySelector(".drag-text");d.textContent=`âœ… ${s.name} selected`,d.style.color="var(--mpc-red)"}else R()}}r.addEventListener("change",O)}_();
